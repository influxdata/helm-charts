Thank you for installing {{ .Chart.Name }}!

Your InfluxDB 3 Enterprise cluster has been deployed to namespace {{ .Release.Namespace }}.

Components deployed:
{{- if .Values.ingester.enabled }}
  ✓ Ingesters: {{ .Values.ingester.replicas }} replica(s)
{{- end }}
{{- if .Values.querier.enabled }}
  ✓ Queriers: {{ .Values.querier.replicas }} replica(s)
{{- end }}
{{- if .Values.compactor.enabled }}
  ✓ Compactor: 1 replica
{{- end }}
{{- if .Values.processingEngine.enabled }}
  ✓ Processing Engine: {{ .Values.processingEngine.replicas }} replica(s)
{{- end }}

Access endpoints:
{{- if .Values.ingress.write.enabled }}
  Write endpoint: http{{ if .Values.ingress.write.tls }}s{{ end }}://{{ (index .Values.ingress.write.hosts 0).host }}
{{- else }}
  Write endpoint: kubectl port-forward svc/{{ include "influxdb3-enterprise.fullname" . }}-ingester 8181:8181 -n {{ .Release.Namespace }}
{{- end }}

{{- if .Values.ingress.query.enabled }}
  Query endpoint: http{{ if .Values.ingress.query.tls }}s{{ end }}://{{ (index .Values.ingress.query.hosts 0).host }}
{{- else }}
  Query endpoint: kubectl port-forward svc/{{ include "influxdb3-enterprise.fullname" . }}-querier 8181:8181 -n {{ .Release.Namespace }}
{{- end }}

Getting started:

  1. Create an admin token:

     kubectl exec -it {{ include "influxdb3-enterprise.fullname" . }}-ingester-0 -n {{ .Release.Namespace }} -- \
        influxdb3 create token --admin

  2. Create a health probe token (required if probes.enabled=true):

     kubectl exec -it {{ include "influxdb3-enterprise.fullname" . }}-ingester-0 -n {{ .Release.Namespace }} -- \
        influxdb3 create token --name "System health token" --permission "system:health:read" --token <your-admin-token>

     Then configure the probe token:

     Option A - Set in values.yaml (not recommended for production):
       probes:
         enabled: true
         token: "<your-probe-token>"

     Option B - Create a Kubernetes secret (recommended):
       kubectl create secret generic influxdb3-probe-token \
         --from-literal=token="<your-probe-token>" \
         -n {{ .Release.Namespace }}

       Then set in values.yaml:
       probes:
         enabled: true
         tokenSecret:
           name: "influxdb3-probe-token"
           key: "token"

     After configuring the probe token, redeploy the chart to enable probes:
       helm upgrade {{ .Release.Name }} influxdata/{{ .Chart.Name }} -f values.yaml -n {{ .Release.Namespace }}

  3. Create a database:

     export INFLUXDB3_AUTH_TOKEN=<your-admin-token>
{{- if and .Values.ingress.write.enabled (index .Values.ingress.write.hosts 0).host }}
     export INFLUXDB3_HOST_URL=http{{ if .Values.ingress.write.tls }}s{{ end }}://{{ (index .Values.ingress.write.hosts 0).host }}
{{- else }}
     export INFLUXDB3_HOST_URL=http://localhost:8181
{{- end }}
     influxdb3 create database mydb

  4. Write data:

     influxdb3 write mydb "measurement field=value"

  5. Query data:

     influxdb3 query mydb "SELECT * FROM measurement"

Documentation: https://docs.influxdata.com/influxdb3/enterprise/

{{- if not .Values.license.email }}
{{- if not .Values.license.existingSecret }}

⚠️  WARNING: No license configured!
    Set .Values.license.email or .Values.license.existingSecret to activate your license.
{{- end }}
{{- end }}
